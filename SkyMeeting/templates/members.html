{% extends 'base.html'%}
{% load i18n %}

{%block title%}SkyMeeting{%endblock%}

{%block cssfile%}
<!-- others -->
<link href="../public/css/uniform.default.css" rel="stylesheet">
<link href="../public/css/chosen.css" rel="stylesheet">

<link rel="stylesheet" type="text/css" href="../public/css/specific/members.css">
{%endblock%}

{%block content%}
<div class="container">
	<h3>{% trans "Members" %}</h3>

	<div class="container-fluid" style="padding-left:0px;">
		<div class="row-fluid">
			<div class="span3">
  				<!--Sidebar content-->
  				<ul class="nav nav-list side-nav" id="groupList">
  					{% if conf.current_gid == -1 %}
  					<li class="active">
  					{% else %}
  					<li>
					{% endif %}
  						<a href="?gid=-1">
  							<span class="group-name">{% trans "All" %}</span>
  							<span class="group-size">({{ groupAllCount }})</span>
  							<!-- groupAllCount??? -->
  							<i class="icon-chevron-right"></i>
  						</a>
  					</li>
  					{% for group in groupAll %}
  						{% if group.gid == conf.current_gid %}
					<li class="active">
						{% else %}
					<li>
						{% endif %}
  						<a href="?gid={{ group.gid }}">
  							<span class="group-name">{{ group.gname }}</span>
  							<span class="group-size">({{ group.count }})</span>
  							<i class="icon-chevron-right"></i>
  						</a>
  						<div class="group-action hide">
	  						<a href="javascript:void(0);" class="edit-group" title="{% trans 'Edit group' %}"><i class="icon-edit"></i></a>
							<a href="javascript:void(0);" class="delete-group" title="{% trans 'Delete group' %}"><i class="icon-trash"></i></a>
							<input type="hidden" data-gid="{{ group.gid }}" data-gname="{{ group.gname }}" />
						</div>
  					</li>
  					{% endfor %}
  				</ul>

  				<!-- current storage -->
  				<input type="hidden" id="curGroupId" data-value="{{ conf.current_gid }}" />
  				<input type="hidden" id="globalGroupString" data-value="{{ groupString }}" />

  				<div class="row-fluid new-item-row">
  					<a href="javascript:void(0);" id="addGroupLink">+&nbsp;{% trans "Create new group" %}</a>
  				</div>

  				<div class="row-fluid hide" id="addGroupDiv">
  					<div class="popup-div-header-small" id="addGroupHeader">
  						<a href="javascript:void(0);" class="close">x</a>
  					</div>
  					<div class="popup-div-inner-small">
  						<div class="row-fluid">
	  						<label for="newGroupName">{% trans "Group name" %}</label>
	  						<input type="text" id="newGroupName" />
	  						<input type="button" class="btn btn-mini btn-primary" id="addGroupOk" value="{% trans 'OK' %}" />
  						</div>
  						<div class="row-fluid alert-msg" id="addGroupErr">
  							<!-- add by js -->
  						</div>
  					</div>
  				</div>
			</div>





			<div class="span9">
  				<!--Body content-->
  				<!-- tags -->
  				<div class="row-fluid" id="tagsDiv">
  					<span id="tagsDivLabel">{% trans "Tags" %}:</span>
  					<ul class="inline" id="tagList">
  						{% for tag in tagAll %}
  							{% if tag.tid in conf.current_tid %}
  						<li><a class="tag tag-selected" data-tid="{{ tag.tid }}">{{ tag.tname }}</a></li>
  							{% else %}
  						<li><a class="tag" data-tid="{{ tag.tid }}">{{ tag.tname }}</a></li>
  							{% endif %}
  						{% endfor %}
  					</ul>

  					<!-- actions -->
					<a href="javascript:void(0);" id="editTagsLink">{% trans "Edit" %}</a>
					<input type="button" class="btn btn-mini btn-primary hide" id="editTagsOk" value="{% trans 'OK' %}" />

					<!-- current storage -->
  					<input type="hidden" id="curTagId" data-value="{{ conf.current_tid }}" />
  					<input type="hidden" id="globalTagString" data-value="{{ tagString }}" />
  				</div>

  				<!-- tags management -->
  				<div class="row-fluid hide" id="editTagsDiv">
  					<div id="tagsArea">
  						{% for tag in tagAll %}
  						<div class="tag">
  							<span>{{ tag.tname }}</span>
  							<a href="javascript:void(0);" class="delete-tag" data-tid="{{ tag.tid }}">x</a>
  						</div>
  						{% endfor %}
  						<span>
  							<input type="text" id="editNewTag" maxlength="10" />
  							<!-- max length??? error hint??? -->
  						</span>
  					</div>
  				</div>
  				
  				<!-- add tag hint -->
  				<div class="hide" id="addTagHintDiv">
  					<div id="addTagHint">{% trans "10 characters limited, separated by space" %}</div>
  					<div class="alert-msg" id="addTagErr"></div>
  				</div>


  				<!-- members table -->
  				<table class="table table-striped table-bordered table-hover" id="membersTable">
					<thead>
						<tr role="row">
							<th>{% trans "Name" %}</th>
							<th>{% trans "Gender" %}</th>
							<th>{% trans "ID Card" %}</th>
							<th>{% trans "Phone" %}</th>
							<th>{% trans "Email" %}</th>
							<th>{% trans "Tags" %}</th>
							<th>{% trans "OP" %}</th>
						</tr>
					</thead>
					<tbody>
						{% for role in memberAll %}
						<tr>
							<td><a href="javascript:void(0);" class="edit-member">{{ role.name }}</a></td>
							<td>
								{% if role.sex == 1 %}
									{% trans "Male" %}
								{% elif role.sex == 0 %}
									{% trans "Female" %}
								{% else %}
									{% trans "Secret" %}
								{% endif %}
							</td>
							<td>{{ role.idcard }}</td>
							<td>{{ role.phone }}</td>
							<td>{{ role.email }}</td>
							<td>
								<a href="javascript:void(0);" data-toggle="tooltip" data-placement="right" 
									data-original-title="
										{% for tag in role.tags.all %}
											{{ tag.tname }},
										{% endfor %}
									">
									{% for tag in role.tags.all %}
										{{ tag.tname }},
									{% endfor %}
								</a>
								<!-- substring of tooltip??? -->
							</td>
							<td>
								<a href="javascript:void(0);" class="image-link edit-member" title="{% trans 'Edit member' %}">
									<i class="icon-edit icon-green"></i>
								</a>
								<a href="javascript:void(0);" class="image-link delete-member" title="trans 'Delete member' %}">
									<i class="icon-trash icon-red"></i>
								</a>
							</td>
							<input type="hidden" data-id="{{ role.rid }}" data-name="{{ role.name }}" data-sex="{{ role.sex }}" data-idcard="{{ role.idcard }}" data-phone="{{ role.phone }}" data-email="{{ role.email }}" data-location="{{ role.location }}" data-groups="{{ role.groups.getAllString }}" data-tags="{{ role.tags.getAllString }}" />
						</tr>
						{% endfor %}
					</tbody>
				</table>



				<div class="row-fluid new-item-row">
					<a href="#inviteModal" data-toggle="modal">+&nbsp;{% trans "Invite new member" %}</a>
				</div>
				<div class="row-fluid pagination-row">
					<div class="pagination">
					  <ul>
					    <li class="prev disabled"><a href="javascript:void(0);">← {% trans "Previous" %}</a></li>
					    <li class="active"><a href="javascript:void(0);">1</a></li>
					    <li><a href="javascript:void(0);">2</a></li>
					    <li><a href="javascript:void(0);">3</a></li>
					    <li><a href="javascript:void(0);">4</a></li>
					    <li><a href="javascript:void(0);">5</a></li>
					    <li class="next"><a href="javascript:void(0);">{% trans "Next" %} → </a></li>
					  </ul>
					</div>
				</div>
			</div>

		</div>
	</div>

</div>







<!-- Popup div -->
<div class="popup-div hide" id="editGroupDiv">
	<div class="popup-div-header-small" id="editGroupHeader">
		<a href="javascript:void(0);" class="close">x</a>
	</div>
	<div class="popup-div-inner-small">
		<div class="row-fluid">
			<label for="editGroupName">{% trans "Edit group name" %}</label>
			<input type="text" id="editGroupName" />
			<input type="button" class="btn btn-primary btn-mini" id="editGroupOk" value="{% trans 'OK' %}" />
			<input type="hidden" id="editGroupId" />
		</div>
		<div class="row-fluid alert-msg" id="editGroupErr">
			<!-- add by js -->
		</div>
	</div>
</div>



<div class="popup-div hide" id="deleteGroupDiv">
	<div class="popup-div-header" id="deleteGroupHeader">
		<a href="javascript:void(0);" class="close">x</a>
	</div>
	<div class="popup-div-inner">
		<div class="popup-delete-hint alert-msg">
			{% trans "Are you sure to delete group" %}
			<span class="popup-strong-hint" id="deleteGroupName"></span>
			{% trans "from your company?" %}
		</div>
		<input type="hidden" id="deleteGroupId" />
		<div class="popup-action-div">
			<input type="button" class="btn btn-primary" id="deleteGroupOk" value="{% trans 'OK' %}" />
			<input type="button" class="btn" id="deleteGroupCancel" value="{% trans 'Cancel' %}" />
		</div>
	</div>
</div>



<div class="popup-div hide" id="deleteUserDiv">
	<div class="popup-div-header" id="deleteUserHeader">
		<a href="javascript:void(0);" class="close">x</a>
	</div>
	<div class="popup-div-inner">
		<div class="popup-delete-hint alert-msg">
			{% trans "Are you sure to delete user" %}
			<span class="popup-strong-hint" id="deleteUserName"></span>
			{% trans " from your company?" %}
		</div>
		<input type="hidden" id="deleteUserId" />
		<div class="popup-action-div">
			<input type="button" class="btn btn-primary" id="deleteUserOk" value="{% trans 'OK' %}" />
			<input type="button" class="btn" id="deleteUserCancel" value="{% trans 'Cancel' %}" />
		</div>
	</div>
</div>







<!-- Popup Modal -->
<!-- Invite new member block -->
<div class="modal hide fade" id="inviteModal" role="dialog" aria-labelledby="inviteModalLabel" aria-hidden="true">
	<div class="modal-header">
		<!-- <input type="button" class="close" data-dismiss="modal" aria-hidden="true" value="x" /> -->
		<a href="javascript:void(0);" class="close" role="button" data-dismiss="modal" aria-hidden="true">x</a>
		<h3 id="inviteModalLabel">{% trans "Invite new member" %}</h3>
	</div>
	<form class="form-horizontal" id="inviteForm">
		<div class="modal-body">
			<div class="control-group">
				<label class="control-label" for="inputName">{% trans "Name" %}</label>
				<div class="controls">
					<input type="text" id="inputName" placeholder="{% trans 'Name' %}" data-validate-presence="true" data-validate-error="#inputNameError" />
					<div class="alert-msg hide" id="inputNameError">
						{% trans "Name cannot be blank." %}
					</div>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label" for="inputIDno">{% trans "ID Card Number" %}</label>
				<div class="controls">
					<input type="text" id="inputIDno" placeholder="{% trans 'ID Card Number' %}" data-validate-presence="true" data-validate-format="/^[0-9]+$/" data-validate-error="#inputIDnoError" />
					<div class="alert-msg hide" id="inputIDnoError">
						{% trans "Should be a ID card number." %}
					</div>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label" for="inputPhone">{% trans "Phone" %}</label>
				<div class="controls">
					<input type="text" id="inputPhone" placeholder="{% trans 'Phone' %}" data-validate-presence="true" data-validate-format="/^[0-9]+$/" data-validate-error="#inputPhoneError" />
					<div class="alert-msg hide" id="inputPhoneError">
						{% trans "Should be a phone number." %}
					</div>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label" for="inputEmail">{% trans "Email" %}</label>
				<div class="controls">
					<input type="text" id="inputEmail" placeholder="{% trans 'Email' %}" data-validate-email="true" data-validate-error="#inputEmailError" />
					<div class="alert-msg hide" id="inputEmailError">
						{% trans "Should be an email address." %}
					</div>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label">{% trans "Authority" %}</label>
				<div class="controls">
					<label class="radio inline">
						<div class="radio">
							<span class="checked">
								<input type="radio" id="authParticipant" name="authority" value="0" checked="checked" />
							</span>
						</div>
						{% trans "Participant" %}
					</label>
					<label class="radio inline">
						<div class="radio">
							<span>
								<input type="radio" id="authOrganizer" name="authority" value="1" />
							</span>
						</div>
						{% trans "Organizer" %}
					</label>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label">{% trans "Verification mode" %}</label>
				<div class="controls">
					<label class="checkbox">
						<div class="checker">
							<span>
								<input type="checkbox" id="checkName" name="verifyMode" value="1" />
							</span>
						</div>
						{% trans "Name" %}
					</label>
					<label class="checkbox">
						<div class="checker">
							<span>
								<input type="checkbox" id="checkIDno" name="verifyMode" value="2" />
							</span>
						</div>
						{% trans "ID Card Number" %}
					</label>
					<label class="checkbox">
						<div class="checker">
							<span>
								<input type="checkbox" id="checkOther" name="verifyMode" value="9" />
							</span>
						</div>
						{% trans "Other question" %}
					</label>
				</div>
			</div>
			<!-- Verification method of other question -->
			<div class="row-fluid hide" id="otherQuestionDiv">
				<div class="control-group">
					<label class="control-label" for="inputQuestion">{% trans "Question" %}</label>
					<div class="controls">
						<input type="text" id="inputQuestion" placeholder="{% trans 'Question' %}" />
						<div class="alert-msg hide" id="inputQuestionError">
							{% trans "Question cannot be blank." %}
						</div>
					</div>
				</div>
				<div class="control-group">
					<label class="control-label" for="inputAnswer">{% trans "Answer" %}</label>
					<div class="controls">
						<input type="text" id="inputAnswer" placeholder="{% trans 'Answer' %}" />
						<div class="alert-msg hide" id="inputAnswerError">
							{% trans "Answer cannot be blank." %}
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="modal-footer">
			<input type="button" class="btn btn-primary" id="inviteModalOk" value="{% trans 'Send invitation' %}" data-validate="#inviteForm" />
			<input type="button" class="btn" data-dismiss="modal" aria-hidden="true" value="{% trans 'Cancel' %}" />
		</div>
	</form>
</div>





<!-- Edit member block -->
<div class="modal hide fade" id="editModal" role="dialog" aria-labelledby="editModalLabel" aria-hidden="true">
	<div class="modal-header">
		<!-- <input type="button" class="close" data-dismiss="modal" aria-hidden="true" value="x" /> -->
		<a href="javascript:void(0);" class="close" role="button" data-dismiss="modal" aria-hidden="true">x</a>
		<h3 id="editModalLabel">{% trans "Edit member" %}</h3>
	</div>
	<form class="form-horizontal" id="memberForm">
		<div class="modal-body">
			<!-- basic -->
			<div class="control-group">
				<label class="control-label" for="editName">{% trans "Name" %}</label>
				<div class="controls">
					<input type="text" id="editName" placeholder="{% trans 'Name' %}" data-validate-presence="true" data-validate-error="#editNameError" />
					<div class="alert-msg hide" id="editNameError">
						{% trans "Name cannot be blank." %}
					</div>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label">{% trans "Gender" %}</label>
				<div class="controls">
					<label class="radio inline">
						<div class="radio">
							<span class="checked">
								<input type="radio" id="genderMale" name="editGender" value="1" />
							</span>
						</div>
						{% trans "Male" %}
					</label>
					<label class="radio inline">
						<div class="radio">
							<span>
								<input type="radio" id="genderFemale" name="editGender" value="0" />
							</span>
						</div>
						{% trans "Female" %}
					</label>
					<label class="radio inline">
						<div class="radio">
							<span>
								<input type="radio" id="genderSecret" name="editGender" value="-1" />
							</span>
						</div>
						{% trans "Secret" %}
					</label>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label" for="editIDno">{% trans "ID Card Number" %}</label>
				<div class="controls">
					<input type="text" id="editIDno" placeholder="{% trans 'ID Card Number' %}" data-validate-presence="true" data-validate-format="/^[0-9]+$/" data-validate-error="#editIDnoError" />
					<div class="alert-msg hide" id="editIDnoError">
						{% trans "Should be a ID card number." %}
					</div>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label" for="editPhone">{% trans "Phone" %}</label>
				<div class="controls">
					<input type="text" id="editPhone" placeholder="{% trans 'Phone' %}" data-validate-presence="true" data-validate-format="/^[0-9]+$/" data-validate-error="#editPhoneError" />
					<div class="alert-msg hide" id="editPhoneError">
						{% trans "Should be a phone number." %}
					</div>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label" for="editEmail">{% trans "Email" %}</label>
				<div class="controls">
					<input type="text" id="editEmail" placeholder="{% trans 'Email' %}" data-validate-email="true" data-validate-error="#editEmailError" />
					<div class="alert-msg hide" id="editEmailError">
						{% trans "Should be an email address." %}
					</div>
				</div>
			</div>


			<!-- groups -->
			<div class="control-group">
				<label class="control-label">{% trans "Groups Belonged To" %}</label>
				<div class="controls">
					<div id="groupCbxDiv">
						<!-- 
						<label class="checkbox">
							<div class="checker">
								<span>
									<input type="checkbox" name="editGroup" value="group.gid" />
								</span>
							</div>
							group.gname
						</label>
						 -->
					</div>
					<div id="dynGroups">
						<!-- add dynamically by js -->
					</div>

					<!-- dynamically add groups -->
					<div class="row-fluid">
						<a href="javascript:void(0);" id="dynAddGroup">+&nbsp;{% trans "Add new group" %}</a>
					</div>
					<div class="row-fluid hide" id="dynAddGroupDiv">
						<div class="row-fluid">
							<input type="text" id="dynNewGroupName" />
							<a href="javascript:void(0);" id="dynAddGroupOk"><i class="icon-ok"></i></a>
							<a href="javascript:void(0);" id="dynAddGroupCancel"><i class="icon-remove-sign"></i></a>
						</div>
						<div class="row-fluid alert-msg" id="dynAddGroupErr">
							<!-- add message dynamically by js -->
						</div>
					</div>
					
				</div>
			</div>


			<!-- tags -->
			<div class="control-group">
				<label class="control-label">{% trans "Tags" %}</label>
				<div class="controls">
					<div id="tagSectDiv">
						<select id="tagSect" multiple="multiple" data-rel="chosen" >
							<!-- add by js -->
						</select>
					</div>

					<!-- dynamically add tags -->
					<div class="row-fluid">
						<a href="javascript:void(0);" id="dynAddTag">+&nbsp;{% trans "Add new tag" %}</a>
					</div>
					<div class="row-fluid hide" id="dynAddTagDiv">
						<div class="row-fluid">
							<input type="text" id="dynNewTagName" />
							<a href="javascript:void(0);" id="dynAddTagOk"><i class="icon-ok"></i></a>
							<a href="javascript:void(0);" id="dynAddTagCancel"><i class="icon-remove-sign"></i></a>
						</div>
						<div class="row-fluid alert-msg" id="dynAddTagErr">
							<!-- add message dynamically by js -->
						</div>
					</div>
					
				</div>
			</div>

			<input type="hidden" id="editId" />
			<div class="form-end"></div>
		
		</div>
		<div class="modal-footer">
			<input type="button" class="btn btn-primary" id="editModalOk" value="{% trans 'Save changes' %}" data-validate="#memberForm" />
			<input type="button" class="btn" data-dismiss="modal" aria-hidden="true" value="{% trans 'Cancel' %}" />
		</div>
	</form>
</div>
{%endblock%}

{%block morestatic%}
<!-- <script src="../public/js/jquery.uniform.min.js"></script> -->
<script src="../public/js/uniform.default.js"></script>
<!-- <script src="../public/js/jquery.chosen.min.js"></script> -->
<script src="../public/js/jquery.chosen.js"></script>
<!-- lib for scroll plugin -->
<script src="../public/js/jquery.scrollTo.min.js"></script>

<script type="text/javascript" src="../public/js/specific/members.js"></script>
{%endblock%}
